<html>
<head>
    <title>WebStandard example</title>
    <meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no"/>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.4/jquery.min.js"></script>
    <script type="text/javascript" src="https://service.iamport.kr/js/iamport.payment-1.1.5.js"></script>
</head>

<body>
<form action="/payment/startPay", method="post" name="testForm">
    <div>
        <label for="card_number">카드 번호 XXXX-XXXX-XXXX-XXXX</label>
        <input id="card_number" type="text" name="card_number">
    </div>
    <div>
        <label for="expiry">카드 유효기간 YYYY-MM</label>
        <input id="expiry" type="text" name="expiry">
    </div>
    <div>
        <label for="birth">생년월일 YYMMDD</label>
        <input id="birth" type="text" name="birth">
    </div>
    <div>
        <label for="pwd_2digit">카드 비밀번호 앞 두자리 XX</label>
        <input id="pwd_2digit" type="text" name="pwd_2digit">
    </div>
<!--    <p>테스트 결제 창~~~</p>-->
    <input type="hidden" value="2234" name="customer_uid">
    <input type="hidden" value="1000" name="price">
    <input type="hidden" value="TestProduct" name="price">
    <input id="check_module" type="submit" value="결제하기">
</form>


</body>
<script>
// let form = document.testForm;

// "/subscription/issue-billing"에 대한 POST 요청을 처리
// $.post("https://api.iamport.kr/subscribe/payments/onetime", async (req, res) => {
//     try {
//         const {
//             card_number = $("#card_number").val(), // 카드 번호
//             expiry = $("#expiry").val(), // 카드 유효기간
//             birth = $("#birth").val(), // 생년월일
//             pwd_2digit = $("#pwd_2digit").val(), // 카드 비밀번호 앞 두자리,
//             customer_uid = $("#customer_uid").val(), // 카드(빌링키)와 1:1로 대응하는 값
//         } = req.body; // req의 body에서 카드정보 추출
//         console.log(req.body);
//         alert(req.body);
//         // 인증 토큰 발급 받기
//         const getToken = await axios({
//             url: "https://api.iamport.kr/users/getToken",
//             method: "post", // POST method
//             headers: { "Content-Type": "application/json" }, // "Content-Type": "application/json"
//             data: {
//                 imp_key: "imp_apikey", // REST API 키
//                 imp_secret: "ekKoeW8RyKuT0zgaZsUtXXTLQ4AhPFW3ZGseDA6bkA5lamv9OqDMnxyeB9wqOsuO9W3Mx9YSJ4dTqJ3f" // REST API Secret
//             }
//         });
//         const { access_token } = getToken.data.response; // 인증 토큰
//     } catch (e) {
//         res.status(400).send(e);
//     }
// });

// $("#check_module").click(function () {
//     var IMP = window.IMP; // 생략가능
//     IMP.init('imp82864473');
//     // 'iamport' 대신 부여받은 "가맹점 식별코드"를 사용
//     // i'mport 관리자 페이지 -> 내정보 -> 가맹점식별코드
//     IMP.request_pay({
//         pg : 'nice',
//         pay_method : 'card',
//         merchant_uid: "merchant_1" + new Date().getTime(), //상점에서 생성한 고유 주문번호
//         customer_uid: "aaaa1",
//         name : "test_11223",
//         amount : 1000,
//         buyer_email : 'iamport@siot.do',
//         buyer_name : '구매자이름',
//         buyer_tel : '010-1234-5678',
//     },  function(rsp) {
//         if ( rsp.success ) {
//             alert('결제 성공');
//         } else {
//             alert('결제 실패');
//         }
//     });
// });
</script>
</html>