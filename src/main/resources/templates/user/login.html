<!DOCTYPE HTML>
<!--
	Hypothesis by Pixelarity
	pixelarity.com | hello@pixelarity.com
	License: pixelarity.com/license
-->
<html  lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
    <title>로그인</title>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no" />
    <link rel="stylesheet" href="/css/main.css" />
</head>
<style>
    a {
        border-bottom: none;
    }
</style>
<body class="is-preload">

<!-- Wrapper -->
<div id="wrapper">

    <!-- Header -->
    <header id="header">
    </header>
    <div class="tab">
        <button class="tablinks" onclick="openLogin(event, 'login')"id="defaultOpen">로그인</button>
        <button class="tablinks" onclick="openLogin(event, 'join')">회원가입</button>
    </div>

    <!-- Section -->
    <section id="one" class="main alt">
        <div class="inner alt">
            <div class="content main">
                <div id="login" class="tabcontent" style="margin-top: 7%;">
                    <section class="tiles" style="margin:0 auto; width:61%">
                        <form method="post" action="/user/userLogin" name="loginForm">
                            <div>
                                <div>
                                    <div style="float: left;"><h3><i class="fas fa-user">  회원 로그인</i></h3></div>
                                    <div><input type="button" id="goDocLogin" value="의사 로그인" style="box-shadow: none;"></div>
                                    <div style="margin-top: 2%;"><h6>건강상담을 위해서는 로그인이 필요합니다.</h6></div>
                                    <div id="loginFail" style="margin-bottom: 5px;"></div>
                                    <div>
                                        <div  style="width:100%">
                                            <p style="margin:0;">아이디 </p>
                                            <input type="text" name="userId" id="member_id"placeholder="ID" value=""/>
                                            <br>
                                            <p style="margin:0;">비밀번호</p>
                                            <input type="password" name="userPw" id="member_pw" placeholder="PassWord" value=""/>
                                            <div style="text-align:center; margin-top:9%">
                                                <a id="findId">아이디 찾기</a><span>&nbsp;|&nbsp;</span><a id="findPw">비밀번호 찾기</a>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-12">
                                        <ul class="actions" style="display:block; text-align:center; margin-top:9%">
                                            <li><input type="submit" value="로그인" class="primary" style="width:100%; font-size:1em;border-radius: 0;" onclick=""/></li>
                                        </ul>
                                    </div>
                                </div>
                            </div>
                        </form>

                    </section>
                </div>
                <div id="join" class="tabcontent" style="width: 90%; margin: 5%;">
                    <section class="tiles">
                        <form method="post" action="/user/SignUp" name="memberSignUpForm">
                            <div>
                                <header>
                                    <div style="float:left;"><h3><i class="fas fa-user">   회원가입</i></h3></div>
                                    <div style="margin-left: 23%;"> <input class="signup" id="signup" type="button" value="의사회원가입" style="box-shadow: none;background-color:rgb(255 255 255 / 85%)!important;"></div>
                                    </header>

                                <label style="margin-top: 10%;display: inline-block;margin-left: -28%;">아이디<input type="text" placeholder="4자 이상, 16자 이하로 입력해주세요." name="userId" id="userId" style="width: 207%;">
                                </label><button type="button" onclick="fn_idChk()" id="checkId" style="margin-left: 25%;border-radius: 0;padding-top: 0.3%;">중복확인</button>
                                <label>비밀번호<input type="password" placeholder="8자리 이상, 대문자/소문자/숫자/특수문자 모두 포함" name="userPw"></label>
                                <label>이름<input type="text" placeholder="이름 입력" name="userName"></label>

                                <label>이메일</label>
                                <label style="display: inline-flex;width: 100%;">
                                    <input type="text" placeholder="" name="userEmail1" id="user_email" style="width: 55%;">
                                    <span>@</span>
                                        <span id="inputEmail">
                                    <select
                                            id="email_select" name='userEmail2' style="border-radius: 0;width: 117%">
                                        <option selected disabled>선택</option>
                                        <option value="naver.com">naver.com</option>
                                        <option value="daum.net">daum.net</option>
                                        <option value="gmail.com">gmail.com</option>
                                        <option value="nate.com">nate.com</option>
                                        <option value="hotmail.com">hotmail.com</option>
                                        <option value="icloud.com">icloud.com</option>
                                        <option value="outlook.com">outlook.com</option>
                                        <option value="_manual">직접입력</option>
                                    </select> </span></label>

                                <!--coolSms-->
                                <label>전화번호</label>
                                <label style="display: inline-flex; width: 100%;"><input type="text" placeholder="휴대폰 번호(-제외)"
                                                                                         name="userPhoneNum" id="userPhoneNum">
                                    <input type="button" value="인증번호 전송" class="button primary" onclick=""
                                           style="border-radius: 0;" id="checkNum" ></label>
                                <label>본인인증</label>
                                <label style="display: inline-flex; width: 100%;"><input type="text" placeholder="인증번호를 입력해주세요"
                                                                                         name="numStr" id="numStr">
                                    <input type="button" value="확인" class="button primary" onclick=""
                                           style="border-radius: 0;width: 46%;" id="checkNumStr" ></label>

                                <!--coolSms끝-->
                                <!--이용약관-->
                                <label style="padding-top: 40px;">이용약관</label>
                                <fieldset>
                                    <div class="col-12">
                                        <input type="checkbox" id="agreeAll" name="agreeAll"
                                               onclick="selectAll(this)"> <label for="agreeAll"style="margin-bottom: -2%;"><strong>전체
                                        동의하기</strong></label>
                                    </div>
                                    <hr>
                                    <div class="col-12">
                                        <input type="checkbox" id="agree" name="term" class="terms"
                                               onclick="checkSelectAll()"> <label for="agree"><strong>[필수]</strong><a
                                            href="http://localhost:10007/privacyPolicy"
                                            target="_blank">&nbsp;개인정보 수집 및 이용 동의</a></label>
                                    </div>
                                    <div class="col-12">
                                        <input type="checkbox" id="term" name="term" class="terms"
                                               onclick="checkSelectAll()"> <label for="term"><strong>[필수]</strong><a
                                            href="http://localhost:10007/terms"
                                            target="_blank">&nbsp;이용약관</a></label>
                                    </div>
                                </fieldset>

                                <!-- 완료 -->
                                <div class="col-12">
                                    <ul class="actions">
                                        <li id="" style="margin: auto;"><input type="button"  value="가입하기"class="button primary large" onclick="formSubmit()" style="width: 10em;border-radius: 0;"/></li>
                                        <input type="hidden" id="email" name="userEmail">
                                    </ul>
                                </div>
                            </div>
                        </form>
                    </section>

                    </div>
                </div>

            </div>
    </section>

    <!-- Footer -->
    <footer id="footer">

    </footer>

</div>

<!-- Scripts -->
<script src="/js/jquery.min.js"></script>
<script src="/js/jquery.dropotron.min.js"></script>
<script src="/js/jquery.selectorr.min.js"></script>
<script src="/js/jquery.scrollex.min.js"></script>
<script src="/js/jquery.scrolly.min.js"></script>
<script src="/js/browser.min.js"></script>
<script src="/js/breakpoints.min.js"></script>
<script src="/js/util.js"></script>
<script src="/js/main.js"></script>
<script src="/js/fix.js"></script>
<script src="https://code.jquery.com/jquery-3.4.1.min.js"></script>
<script th:inline="javascript">
    let error = [[${error}]];
    if(error==0){
        let loginFail = document.getElementById('loginFail');
        loginFail.innerHTML="<span style='color:red;font-size: 15px;font-weight: bold;'>아이디와 비밀번호를 확인해 주세요.</span>";
    }

    let status = [[${status}]];
    if(status == 4){
        let loginFail = document.getElementById('loginFail');
        loginFail.innerHTML="<span style='color:red;font-size: 15px;font-weight: bold;'>현재 정지중인 아이디입니다.</span>";
    }
    if(status == 5){
        let loginFail = document.getElementById('loginFail');
        loginFail.innerHTML="<span style='color:red;font-size: 15px;font-weight: bold;'>탈퇴한 계정입니다.</span>";
    }


    $("#signup").on("click", function(){
        location.href="/user/explanation";
    })
    $("#findId").on("click", function(){
        location.href="/user/userFindId";
    })
    $("#findPw").on("click", function(){
        location.href="/user/userFindPw";
    })

    /*휴대폰 인증*/
    $("#checkNum").on('click',function(){
        $.ajax({
            url : "/user/sendSms",
            type: "post",
            dataType: "json",
            data: {"userPhoneNum":$("#userPhoneNum").val()},
            success : function(numStr){
                $('#checkNumStr').click(function(){
                    if($.trim(numStr)==$('#numStr').val()){
                        alert("인증 성공. 휴대폰인증이 정상적으로 완료되었습니다.");
                    }else{
                        alert("인증 실패. 인증번호를 다시 확인해 주세요.");
                    }
                });
            }
        });
    })
    /*휴대폰인증 끝*/
  /*  /!*시작*!/*/
    // let check = false;
    //
    // function formSubmit(){
    //     let form = document.memberSignUpForm;
    //
    //     if(!form.userName.value){
    //         alert("이름을 확인해주세요");
    //         form.userName.focus();
    //         return;
    //     }
    //
    //     if(form.userId.value.length < 4 || form.userId.value.length > 16){
    //         alert("아이디는 4자 이상, 16자 이하로 입력해주세요.");
    //         form.userId.focus();
    //         return false;
    //     }else{
    //         check = true;
    //     }
    //
    //     if(!form.userId.value || !check){
    //         alert("아이디를 확인해주세요");
    //         form.userId.focus();
    //         return;
    //     }
    //
    //     if(!form.userEmail.value){
    //         alert("이메일을 입력해주세요");
    //         form.userEmail.focus();
    //         return;
    //     }
    //
    //     if(!form.userPhoneNum.value){
    //         alert("휴대폰번호를 입력해주세요");
    //         form.userPhoneNum.focus();
    //         return;
    //     }
    //
    //     if(!form.userPw.value){
    //         alert("비밀번호를 입력해주세요");
    //         form.userPw.focus();
    //         return;
    //     }else{
    //         //8자리 이상, 대문자/소문자/숫자/특수문자 모두 포함되어 있는 지 검사
    //         let reg = /^(?=.*?[A-Z])(?=.*?[a-z])(?=.*?[0-9])(?=.*?[#?!@$%^&*-]).{8,}$/;
    //         let hangleCheck = /[ㄱ-ㅎ|ㅏ-ㅣ|가-힣]/;
    //
    //         if(!reg.test(form.userPw.value)){
    //             alert("비밀번호는 8자리 이상이어야 하며, 대문자/소문자/숫자/특수문자 모두 포함해야 합니다.");
    //             form.userPw.focus();
    //             return;
    //         }
    //         //비밀번호에 공백을 포함할 수 없다.
    //         if(form.userPw.value.search(/\s/) != -1){
    //             alert("비밀번호에 공백 없이 입력해주세요.");
    //             form.userPw.focus();
    //             return;
    //         }
    //
    //         if(form.userPw.value != form.checkId.value){
    //             alert("비밀번호가 일치하지 않습니다.");
    //             form.userPw.focus();
    //             return;
    //         }
    //     }
    //
    //
    //     check = false;
    //
    //     $.each($(".terms"), function(index, item){
    //         if(!$(item).is(":checked")){
    //             check = true;
    //         }
    //     });
    //
    //     if(check){
    //         alert("이용약관 동의가 필요합니다.");
    //         form.term.focus();
    //         return;
    //     }
    //
    //     form.submit();
    // }

    /*아이디 중복검사*/
    function fn_idChk(){
        $.ajax({
            url : "/user/checkUserId",
            type : "post",
            dataType : "json",
            data : {"userId":$("#userId").val()},
            success : function(data){
                if(data == 1) {
                    alert("중복된 아이디 입니다.");
                }else if(data == 0){
                    $("#checkId").attr("value","Y");
                    alert("사용가능한 아이디 입니다.");
                }
            }

        });
    }


    $(document).keypress(function(e) { if (e.keyCode == 13) e.preventDefault(); });


    $("#goDocLogin").on("click", function(){
        location.href="/user/docLogin";
    })



    /*!!!!!!!끝!!!!!!!!*/

 /*   /!*아이디 중복검사*!/
    function checkId(id){
        check = false;

        if(id == ""){
            $("#idCheck_text").text("");
            return;
        }*/

        // let userId = document.getElementById("userId").value;
        //
        // let xhr = new XMLHttpRequest();
        // xhr.open("GET", "/user/checkId?userId="+ userId, true);
        // xhr.send();
        //
        // /* 	xhr.open("POST","request_ajax.jsp",true);
        //     xhr.setRequestHeader("Content-Type","application/x-www-form-urlencoded");
        //     xhr.send("city=Seoul&zipcode=45466"); */
        //
        // xhr.onreadystatechange = function() {
        //     if (xhr.readyState == XMLHttpRequest.DONE && xhr.status == 200) {
        //         document.getElementById("idCheck_text").innerHTML = xhr.responseText;
        //     }
        // }
/*

        let userId = $('#userId').val();
        $.ajax({
            url: "/user/checkId?userId="+ userId,
            type:"get",
            // dataType:"json",
            success:function(result){
                alert(result);
                $("#idCheck_text").replaceWith(result);
               /!* if(result == "ok"){
                    //DOM
                    $("#idCheck_text").text("사용 가능");
                    $("#idCheck_text").css("color", "blue");
                    check = true;
                }else{
                    //DOM
                    $("#idCheck_text").text("사용 불가");
                    $("#idCheck_text").css("color", "red");
                }*!/
            }
        });
    }

    // let userId2 = document.getElementById("userId");
    // userId2.addEventListener('keyup',function(){
    //     checkId(userId2.value);
    // });
    $("input[id='userId']").keyup(function(){
        //중복 검사
        checkId($(this).val())
    })
    /!*아이디 중복검사 끝*!/
*/



    function openLogin(evt, loginName) {
        // Declare all variables
        var i, tabcontent, tablinks;

        // Get all elements with class="tabcontent" and hide them
        tabcontent = document.getElementsByClassName("tabcontent");
        for (i = 0; i < tabcontent.length; i++) {
            tabcontent[i].style.display = "none";
        }

        // Get all elements with class="tablinks" and remove the class "active"
        tablinks = document.getElementsByClassName("tablinks");
        for (i = 0; i < tablinks.length; i++) {
            tablinks[i].className = tablinks[i].className.replace(" active", "");
        }

        // Show the current tab, and add an "active" class to the button that opened the tab
        document.getElementById(loginName).style.display = "block";
        evt.currentTarget.className += " active";
        }
        document.getElementById("defaultOpen").click();


    function checkSelectAll()  {
// 전체 체크박스
        const checkboxes
            = document.querySelectorAll('input[name="term"]');
// 선택된 체크박스
        const checked
            = document.querySelectorAll('input[name="term"]:checked');
// select all 체크박스
        const selectAll
            = document.querySelector('input[name="agreeAll"]');

        if(checkboxes.length === checked.length)  {
            selectAll.checked = true;
        }else {
            selectAll.checked = false;
        }

    }

    function selectAll(selectAll)  {
        const checkboxes
            = document.getElementsByName('term');

        checkboxes.forEach((checkbox) => {
            checkbox.checked = selectAll.checked
        })
    }


    /*이메일*/

    $(document).ready(function(){
        $('#email_select').change(function(){
            var email = $('#email_select').val(); //id선택자로 email select box값 추출하여 저장
            if(email == '_manual'){ //selectbox value가 _manual이면
                $("#email_select").replaceWith("<input type = 'text' id='input_email' placeholder='직접입력' style='margin: auto !important;'>");
                //selectbox 태그를 input 태그로 변경
                $("#inputEmail").append("<button id='reset' type='button' onclick='check()'>✖</button>");
            }
        });
    });


    function check(){
        var i = document.getElementById('inputEmail');
        var j = document.getElementById('input_email');
        j.value=null;
        i.innerHTML = "<select id='email_select' name='email'style='font-size: 10px !important;'>"+
            "<option selected disabled>선택</option>"+
            "<option value='naver.com'>naver.com</option>"+
            "<option value='daum.net'>daum.net</option>"+
            "<option value='gmail.com'>gmail.com</option>"+
            "<option value='nate.com'>nate.com</option>"+
            "<option value='hotmail.com'>hotmail.com</option>"+
            "<option value='icloud.com'>icloud.com</option>"+
            "<option value='outlook.com'>outlook.com</option>"+
            "<option value='_manual'>직접입력</option></select>";
    };




    function formSubmit() {
        let form= document.memberSignUpForm;
        let email = document.getElementById("email");
        var i = document.getElementById('user_email');
        var j = document.getElementById('email_select');
        email.value = i.value+"@"+ j.value;
        console.log(email.value);
        form.submit();
    }
</script>
</body>
<style>
    .content.main{
        width: 50%;
        border-radius: 25px;
        padding: 2%;
        margin: auto;
        margin-top: 6%;
    }

    .tab {
        overflow: hidden;
        background-color: #f1f1f1;
        height: 4em;
        text-align: center;
        position: fixed;
        width: 100%;
    }

    .signup:hover {
        color: lightseagreen !important;

    }



    /* Create an active/current tablink class */
    .tab button.active {
        background-color: #ccc;
    }
    .tab button {
        box-shadow: none;
        margin-top: 1%;
    }

    input{
        border-radius: 0 !important;
    }
</style>
</html>